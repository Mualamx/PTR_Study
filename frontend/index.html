<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Token认证绕过靶场 - Burp抓包版</title>
    <link rel="stylesheet" href="style.css">
    <!-- 引入配置文件 -->
    <script src="config.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>🎯 Token认证绕过靶场</h1>
            <p>传统页面跳转 | Burp完美抓包 | 配置: <span id="currentConfig"></span></p>
        </header>

        <div class="dashboard">
            <!-- 时间查询 -->
            <div class="card">
                <div class="card-icon">⏰</div>
                <h3>查询当前时间</h3>
                <p>直接链接，Burp可抓包</p>
                <a href="#" id="timeLink" class="test-link" target="_blank">
                    获取服务器时间
                </a>
                <p class="link-desc">点击后在新页面查看时间信息</p>
            </div>
            
            <!-- Token获取 -->
            <div class="card">
                <div class="card-icon">🔑</div>
                <h3>获取Token</h3>
                <p>直接链接，Burp可抓包</p>
                <a href="#" id="tokenLink" class="test-link" target="_blank">
                    获取一次性Token
                </a>
                <p class="link-desc">点击后在新页面获取Token</p>
            </div>
            
            <!-- 用户查询 - 表单方式 -->
            <div class="card">
                <div class="card-icon">👥</div>
                <h3>查询用户信息</h3>
                <p>表单提交，Burp可抓包</p>
                
                <form id="userForm" method="GET" target="_blank" class="token-form">
                    <div class="form-group">
                        <label for="tokenInput">Token参数：</label>
                        <input type="text" id="tokenInput" name="token" placeholder="请输入token" required>
                    </div>
                    <button type="submit" class="form-button">查询用户列表</button>
                </form>
                
                <p class="link-desc">表单提交，Token通过URL参数传递</p>
            </div>

            <!-- 自动测试 -->
            <div class="card">
                <div class="card-icon">🚀</div>
                <h3>自动测试流程</h3>
                <p>一键完成完整测试流程</p>
                
                <div class="test-buttons">
                    <button onclick="autoTest('get')" class="test-btn get-btn">通过GET传参</button>
                    <button onclick="autoTest('header')" class="test-btn header-btn">通过POST Header传参</button>
                    <button onclick="autoTest('json')" class="test-btn json-btn">通过POST Body(JSON)传参</button>
                    <button onclick="autoTest('form')" class="test-btn form-btn">通过POST Body(Form)传参</button>
                    <button onclick="autoTest('multipart')" class="test-btn multipart-btn">通过POST Body(Multipart)传参</button>
                </div>
                
                <p class="link-desc">选择不同的传参方式测试Token认证</p>
            </div>

            <!-- 服务器状态 -->
            <div class="card">
                <div class="card-icon">📊</div>
                <h3>服务器状态</h3>
                <p>直接链接，Burp可抓包</p>
                <a href="#" id="statusLink" class="test-link" target="_blank">
                    查看服务器状态
                </a>
                <p class="link-desc">点击查看服务器运行状态</p>
            </div>

            <!-- 调试信息 -->
            <div class="card">
                <div class="card-icon">🐛</div>
                <h3>调试信息</h3>
                <p>直接链接，Burp可抓包</p>
                <a href="#" id="debugLink" class="test-link" target="_blank">
                    查看请求头信息
                </a>
                <p class="link-desc">点击查看完整的请求头信息</p>
            </div>
        </div>

        <!-- 配置管理 -->
        <div class="config-card">
            <h3>⚙️ 系统配置</h3>
            <div class="config-group">
                <label for="backendUrlInput">后端API地址：</label>
                <input type="text" id="backendUrlInput" placeholder="请输入后端服务器地址">
                <button onclick="updateConfig()">更新配置</button>
            </div>
            <div class="current-config">
                <strong>当前配置：</strong>
                <span id="configDisplay"></span>
            </div>
        </div>

        <!-- 手动测试区域 -->
        <div class="manual-test">
            <h3>🔧 手动测试URL</h3>
            <p>复制以下URL到浏览器地址栏测试：</p>
            <div class="url-list">
                <div class="url-item">
                    <strong>获取Token：</strong>
                    <code id="manualTokenUrl">http://10.211.55.2:8000/getToken</code>
                </div>
                <div class="url-item">
                    <strong>获取时间：</strong>
                    <code id="manualTimeUrl">http://10.211.55.2:8000/api/time</code>
                </div>
                <div class="url-item">
                    <strong>查询用户：</strong>
                    <code id="manualUserUrl">http://10.211.55.2:8000/api/users?token=你的token</code>
                </div>
                <div class="url-item">
                    <strong>服务器状态：</strong>
                    <code id="manualStatusUrl">http://10.211.55.2:8000/api/status</code>
                </div>
            </div>
        </div>

        <!-- 攻击说明 -->
        <div class="attack-guide">
            <h3>🎯 攻击目标说明</h3>
            <p><strong>目标：</strong>绕过 <code>/api/users</code> 接口的Token认证机制</p>
            <p><strong>测试方法：</strong></p>
            <ul>
                <li>使用Burp Suite拦截请求</li>
                <li>修改Token参数或Header</li>
                <li>尝试各种绕过技术</li>
                <li>验证是否成功获取用户数据</li>
            </ul>
            <p><strong>提示：</strong>所有链接都会产生完整的HTTP请求，Burp可以完美抓包分析。</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>